<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Diwali All of You!</title>
  <style>
    :root{
      --bg:#0b1020; /* deep night */
      --accent:#ffd166; /* diya flame */
      --peacock1:#1ea7b8;
      --peacock2:#2d6a4f;
      --rangoli:#ff7b7b;
      --glass: rgba(255,255,255,0.06);
    }
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255,200,150,0.03), transparent), linear-gradient(180deg,var(--bg),#061022 60%);
      color:#fff;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:20px;
    }

    /* container */
    .card{
      width:min(1100px,98vw);height:min(760px,92vh);position:relative;border-radius:18px;overflow:hidden;box-shadow:0 10px 40px rgba(2,6,23,0.8);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.04);
    }

    /* Top Controls */
    .controls{position:absolute;left:20px;top:20px;z-index:30;display:flex;gap:12px;align-items:center}
    .chip{background:var(--glass);padding:10px 14px;border-radius:999px;font-weight:600;letter-spacing:0.6px;font-size:14px}
    .input{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:inherit;outline:none;min-width:320px}
    .btn{background:linear-gradient(90deg,#ffb86b,#ff6b6b);border:none;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.08)}

    /* center stage */
    .stage{position:absolute;inset:0;display:grid;place-items:center}
    .canvas-wrap{position:absolute;inset:0;z-index:1}
    canvas#fireworks{width:100%;height:100%;display:block}

    /* rangoli card */
    .rangoli-card{position:relative;z-index:6;width:min(760px,86vw);height:min(560px,72vh);display:grid;place-items:center}

    /* greeting area */
    .greeting{position:absolute;left:50%;transform:translateX(-50%);bottom:34px;z-index:50;display:flex;flex-direction:column;align-items:center;gap:8px}
    .greeting h1{margin:0;font-size:42px;letter-spacing:1px;text-transform:uppercase;text-shadow:0 4px 26px rgba(0,0,0,0.7)}
    .subtitle{font-size:14px;opacity:0.9}

    /* typing text */
    .typebox{font-family: 'Segoe UI', Roboto, system-ui; font-weight:800; font-size:36px;background:linear-gradient(90deg,#fff,#ffd166);-webkit-background-clip:text;background-clip:text;color:transparent}

    /* floating diyas */
    .diya{position:absolute;bottom:20px;z-index:4;filter:drop-shadow(0 8px 26px rgba(255,150,80,0.14));}
    .diya svg{width:110px;height:110px}
    .lantern{position:absolute;top:40px;left:30px;z-index:6;transform-origin:center}

    /* twinkling lights */
    .lights{position:absolute;top:0;left:0;right:0;height:120px;z-index:45;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .string{width:92%;height:2px;background:linear-gradient(90deg,transparent,#ffd166,transparent);opacity:0.06}
    .bulb{position:absolute;width:8px;height:8px;border-radius:50%;box-shadow:0 0 10px rgba(255,210,100,0.7);opacity:0.85}

    /* small info */
    .footer{position:absolute;right:18px;bottom:18px;color:rgba(255,255,255,0.6);font-size:12px;z-index:50}

    /* responsivity */
    @media (max-width:720px){
      .controls{left:12px;right:12px;top:12px;flex-direction:column;gap:8px}
      .input{min-width:180px}
      .greeting h1{font-size:28px}
      .typebox{font-size:20px}
      .diya svg{width:72px;height:72px}
    }

    /* SVG animations */
    .peacock-part{transform-origin:center;animation:float 6s ease-in-out infinite}
    .feather{animation:shimmer 4s ease-in-out infinite alternate}
    .tail-feather{animation:fan 8s ease-in-out infinite}
    @keyframes float{0%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-6px) rotate(-2deg)}100%{transform:translateY(0) rotate(0deg)}}
    @keyframes shimmer{0%{opacity:0.8}100%{opacity:1}}
    @keyframes fan{0%{transform:rotate(0deg) scale(1)}50%{transform:rotate(2deg) scale(1.02)}100%{transform:rotate(0deg) scale(1)}}

    /* subtle glow around rangoli */
    .glow{position:absolute;inset:0;z-index:2;filter:blur(36px);opacity:0.26}

  </style>
</head>
<body>
  <div class="card" role="main">

    <div class="controls" aria-hidden="false">
      <div class="chip">Happy Diwali my Friends✨</div>
      <input id="nameInput" class="input" placeholder="Enter names, comma-separated — e.g. Varsh, Aashtha, Sakshi" value="Varhsa, Aastha, Sakshi" />
      <button id="playBtn" class="btn">Play</button>
      <button id="stopBtn" class="btn secondary">Stop</button>
      <button id="downloadBtn" class="btn secondary">Download PNG</button>
    </div>

    <!-- twinkling lights -->
    <div class="lights" aria-hidden="true">
      <div class="string"></div>
      <!-- bulbs will be generated by JS -->
    </div>

    <div class="stage">
      <div class="canvas-wrap"><canvas id="fireworks"></canvas></div>

      <div class="rangoli-card" aria-hidden="false">
        <!-- glow layer -->
        <div class="glow" style="background:radial-gradient(circle at 50% 45%, rgba(255,200,120,0.12), transparent 25%), radial-gradient(circle at 30% 70%, rgba(30,167,184,0.06), transparent 22%);"></div>

        <!-- Enhanced SVG Rangoli / Peacock -->
        <svg class="peacock" viewBox="0 0 700 520" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" aria-label="Peacock rangoli">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="#1ea7b8"/>
              <stop offset="1" stop-color="#2d6a4f"/>
            </linearGradient>
            <linearGradient id="g2" x1="0" x2="1">
              <stop offset="0" stop-color="#ffd166"/>
              <stop offset="1" stop-color="#ff7b7b"/>
            </linearGradient>
            <radialGradient id="eyeGrad" cx="50%" cy="50%" r="50%">
              <stop offset="0" stop-color="#ffd166"/>
              <stop offset="1" stop-color="#ff9f43"/>
            </radialGradient>
          </defs>

          <!-- Outer feathers - multiple paths for layered look -->
          <g transform="translate(350,260)">
            <!-- Tail feathers in a fan shape -->
            <g class="tail-feather">
              <!-- Layer 1: Outer feathers -->
              <path d="M0 -20 Q 150 -100 250 50 Q 150 200 0 160 Q -150 200 -250 50 Q -150 -100 0 -20 Z" fill="url(#g1)" opacity="0.3" class="feather"/>
              <!-- Layer 2: Middle feathers -->
              <path d="M0 -15 Q 120 -80 200 40 Q 120 160 0 140 Q -120 160 -200 40 Q -120 -80 0 -15 Z" fill="url(#g1)" opacity="0.4" class="feather"/>
              <!-- Layer 3: Inner feathers -->
              <path d="M0 -10 Q 90 -60 150 30 Q 90 120 0 120 Q -90 120 -150 30 Q -90 -60 0 -10 Z" fill="url(#g1)" opacity="0.5" class="feather"/>
              <!-- Layer 4: Central feathers -->
              <path d="M0 0 Q 60 -40 100 20 Q 60 80 0 100 Q -60 80 -100 20 Q -60 -40 0 0 Z" fill="url(#g2)" opacity="0.6" class="feather"/>
            </g>

            <!-- Decorative small petals around -->
            <g class="peacock-part" style="animation-duration:6.2s;animation-delay:0.2s">
              <g fill="none" stroke-width="3" stroke-linecap="round">
                <path stroke="#ffd166" d="M170 -20 C 160 -12 150 -10 140 2" opacity="0.6"/>
                <path stroke="#ff7b7b" d="M-170 -20 C -160 -12 -150 -10 -140 2" opacity="0.6"/>
                <path stroke="#1ea7b8" d="M0 -180 C 10 -170 20 -165 30 -160" opacity="0.6"/>
                <path stroke="#2d6a4f" d="M0 180 C -10 170 -20 165 -30 160" opacity="0.6"/>
              </g>
            </g>

            <!-- Central lotus / diya base -->
            <g transform="translate(0,40)">
              <ellipse rx="110" ry="34" fill="rgba(0,0,0,0.18)" />
              <g transform="translate(0,-52)">
                <path d="M0 42 C -42 32 -58 10 -54 -18 C -46 -56 -4 -70 0 -70 C 4 -70 46 -56 54 -18 C 58 10 42 32 0 42 Z" fill="#2d6a4f" opacity="0.95"/>
                <path d="M0 36 C -28 28 -40 9 -38 -14 C -32 -45 -4 -56 0 -56 C 4 -56 32 -45 38 -14 C 40 9 28 28 0 36 Z" fill="#1ea7b8" opacity="0.98"/>
                <!-- Inner petal highlights -->
                <path d="M0 -40 L 8 -6 L 0 -2 L -8 -6 Z" fill="#ffd166" opacity="0.92"/>
                <!-- Flame -->
                <g transform="translate(0,-18)">
                  <path d="M0 24 C 12 8 8 -6 0 -22 C -8 -6 -12 8 0 24 Z" fill="#ff9f43"/>
                  <path d="M0 16 C 6 6 4 0 0 -12 C -4 0 -6 6 0 16 Z" fill="#ffd166"/>
                </g>
              </g>
            </g>

            <!-- Eyes of peacock - decorative circles with gradients -->
            <g transform="translate(0,-10)">
              <circle cx="-80" cy="-26" r="8" fill="url(#eyeGrad)"/>
              <circle cx="80" cy="-26" r="8" fill="url(#eyeGrad)"/>
              <circle cx="-60" cy="10" r="6" fill="url(#eyeGrad)" opacity="0.8"/>
              <circle cx="60" cy="10" r="6" fill="url(#eyeGrad)" opacity="0.8"/>
              <circle cx="0" cy="-50" r="10" fill="url(#eyeGrad)" opacity="0.9"/>
            </g>

            <!-- Additional intricate details: small feather spots -->
            <g class="feather">
              <circle cx="120" cy="-40" r="4" fill="#ffd166" opacity="0.7"/>
              <circle cx="-120" cy="-40" r="4" fill="#ff7b7b" opacity="0.7"/>
              <circle cx="90" cy="60" r="3" fill="#1ea7b8" opacity="0.8"/>
              <circle cx="-90" cy="60" r="3" fill="#2d6a4f" opacity="0.8"/>
            </g>

          </g>
        </svg>

      </div>

      <!-- floating diya SVG on the left-bottom -->
      <div class="diya" style="left:28px;bottom:28px;z-index:40;">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="50" cy="78" rx="34" ry="8" fill="rgba(0,0,0,0.18)"/>
          <path d="M20 62 C30 55 40 46 50 44 C60 46 70 55 80 62 C72 68 28 68 20 62 Z" fill="#2b2a2a"/>
          <path d="M36 52 C44 40 56 40 64 52 C56 56 44 56 36 52 Z" fill="#ffd166"/>
          <path d="M50 30 C56 40 54 44 50 48 C46 44 44 40 50 30 Z" fill="#ff7b7b"/>
        </svg>
      </div>

      <!-- lantern top right -->
      <div class="lantern" style="right:36px;top:36px;z-index:40;">
        <svg viewBox="0 0 80 120" width="72" height="110" xmlns="http://www.w3.org/2000/svg">
          <rect x="14" y="12" width="52" height="78" rx="8" fill="#ffb4a2" stroke="#ffd166" stroke-width="2"/>
          <ellipse cx="40" cy="94" rx="24" ry="6" fill="rgba(0,0,0,0.12)"/>
          <g fill="#ffd166"><circle cx="40" cy="46" r="6"/></g>
        </svg>
      </div>

      <!-- greeting text -->
      <div class="greeting">
        <h1>Festival of Lights</h1>
        <div class="typebox" id="typed">Happy Diwali!</div>
    </div>
  </div>

<script>
// ----------------------------
// CONFIG
// ----------------------------
const CONFIG = {
  nameDelay: 2200, // ms each name stays before next
  typingSpeed: 60, // ms per char
  fireworksDensity: 0.9 // 0 to 1
}

// ----------------------------
// Typing / name cycling
// ----------------------------
const typedEl = document.getElementById('typed');
const input = document.getElementById('nameInput');
const playBtn = document.getElementById('playBtn');
const stopBtn = document.getElementById('stopBtn');
const downloadBtn = document.getElementById('downloadBtn');
let names = [];
let play = false;
let loopTimeout = null;
let currentIndex = 0;
let typingTimer = null;

function parseNames(raw){
  return raw.split(',').map(s=>s.trim()).filter(Boolean);
}

async function typeMessage(msg){
  clearTimeout(typingTimer);
  typedEl.textContent = '';
  for(let i=0;i<msg.length;i++){
    typedEl.textContent = msg.slice(0,i+1);
    await new Promise(r=>typingTimer = setTimeout(r, CONFIG.typingSpeed));
    if(!play) return;
  }
}

async function cycleNames(){
  if(names.length===0) return;
  play = true;
  currentIndex = 0;
  while(play){
    const name = names[currentIndex % names.length];
    const msg = `Happy Diwali, ${name}!`;
    await typeMessage(msg);
    await new Promise(r=> loopTimeout = setTimeout(r, CONFIG.nameDelay));
    if(!play) break;
    currentIndex++;
  }
}

playBtn.addEventListener('click', ()=>{
  names = parseNames(input.value || 'Friends');
  if(names.length===0) names=['Friends'];
  if(play) return;
  cycleNames();
});
stopBtn.addEventListener('click', ()=>{ play=false; clearTimeout(loopTimeout); clearTimeout(typingTimer); typedEl.textContent='Happy Diwali!'; });

// ----------------------------
// Twinkling lights generator
// ----------------------------
(function makeLights(){
  const container = document.querySelector('.lights');
  for(let i=0;i<18;i++){
    const b = document.createElement('div');
    b.className='bulb';
    b.style.left = `${6 + Math.random()*88}%`;
    b.style.top = `${18 + Math.random()*60}px`;
    b.style.width = `${6 + Math.random()*6}px`;
    b.style.height = b.style.width;
    b.style.opacity = Math.random()*0.9+0.2;
    b.style.background = ['#ffd166','#ffb86b','#fff
